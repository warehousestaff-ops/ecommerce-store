<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Admin Dashboard &mdash; Store.</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
  <style>
    *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

    :root {
      --black:  #0A0A0A;
      --white:  #FFFFFF;
      --g50:    #FAFAFA;
      --g100:   #F4F4F4;
      --g200:   #E8E8E8;
      --g400:   #AAAAAA;
      --g600:   #666666;
      --border: #E8E8E8;
      --green:  #16A34A;
      --amber:  #D97706;
      --red:    #DC2626;
      --blue:   #2563EB;
    }

    body {
      font-family: 'Inter', sans-serif;
      background: var(--g50);
      color: var(--black);
      min-height: 100vh;
      line-height: 1.6;
      display: flex;
    }

    /* ── Sidebar ──────────────────────────────── */
    .db-sidebar {
      width: 240px;
      min-height: 100vh;
      background: var(--black);
      color: var(--white);
      display: flex;
      flex-direction: column;
      position: fixed;
      top: 0; left: 0; bottom: 0;
      z-index: 50;
    }

    .db-logo {
      padding: 1.75rem 1.5rem 1.5rem;
      border-bottom: 1px solid #1A1A1A;
    }

    .db-logo-name {
      font-weight: 700;
      font-size: 1.15rem;
      letter-spacing: -0.03em;
    }

    .db-logo-name span { color: var(--g400); }
    .db-logo-sub { font-size: 0.67rem; color: #555; letter-spacing: 0.12em; text-transform: uppercase; margin-top: 0.25rem; }

    .db-nav { padding: 1.25rem 0.75rem; flex: 1; display: flex; flex-direction: column; gap: 0.2rem; }

    .db-nav-btn {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      width: 100%;
      background: none;
      border: none;
      border-left: 3px solid transparent;
      padding: 0.72rem 1rem;
      border-radius: 0 3px 3px 0;
      color: #666;
      font-family: 'Inter', sans-serif;
      font-size: 0.78rem;
      font-weight: 500;
      letter-spacing: 0.06em;
      text-transform: uppercase;
      cursor: pointer;
      text-align: left;
      transition: background 0.15s, color 0.15s, border-color 0.15s;
    }

    .db-nav-btn:hover { background: #111; color: #CCC; }
    .db-nav-btn.active { background: #111; color: var(--white); border-left-color: var(--white); }

    .db-nav-icon { width: 15px; height: 15px; flex-shrink: 0; opacity: 0.5; }
    .db-nav-btn.active .db-nav-icon { opacity: 1; }

    .db-back { padding: 1rem 1.5rem; border-top: 1px solid #1A1A1A; }
    .db-back a { font-size: 0.72rem; color: #555; text-decoration: none; letter-spacing: 0.08em; text-transform: uppercase; transition: color 0.15s; }
    .db-back a:hover { color: var(--white); }

    /* ── Main ─────────────────────────────────── */
    .db-main { margin-left: 240px; flex: 1; min-height: 100vh; display: flex; flex-direction: column; }

    .db-topbar {
      background: var(--white);
      border-bottom: 1px solid var(--border);
      padding: 1rem 2rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
      position: sticky;
      top: 0;
      z-index: 40;
    }

    .db-topbar-title { font-weight: 700; font-size: 0.95rem; letter-spacing: -0.01em; }
    .db-topbar-date { font-size: 0.74rem; color: var(--g400); }

    .db-content { padding: 2rem; flex: 1; }

    /* ── Sections ─────────────────────────────── */
    .db-section { display: none; }
    .db-section.active { display: block; }

    .db-page-title { font-weight: 700; font-size: 1.4rem; letter-spacing: -0.03em; margin-bottom: 0.25rem; }
    .db-page-sub { font-size: 0.8rem; color: var(--g400); margin-bottom: 2rem; }

    /* ── Stat cards ───────────────────────────── */
    .stat-cards { display: grid; grid-template-columns: repeat(4, 1fr); gap: 1.25rem; margin-bottom: 2rem; }

    .stat-card {
      background: var(--white);
      border: 1.5px solid var(--border);
      border-radius: 4px;
      padding: 1.5rem;
      border-top: 3px solid var(--black);
    }

    .stat-card.green  { border-top-color: var(--green); }
    .stat-card.amber  { border-top-color: var(--amber); }
    .stat-card.blue   { border-top-color: var(--blue); }

    .stat-label { font-size: 0.67rem; font-weight: 600; letter-spacing: 0.14em; text-transform: uppercase; color: var(--g400); margin-bottom: 0.65rem; }
    .stat-value { font-size: 2.2rem; font-weight: 700; letter-spacing: -0.04em; line-height: 1; }
    .stat-note  { font-size: 0.7rem; color: var(--g400); margin-top: 0.4rem; }

    /* ── Panel ────────────────────────────────── */
    .db-panel { background: var(--white); border: 1.5px solid var(--border); border-radius: 4px; overflow: hidden; margin-bottom: 2rem; }

    .db-panel-head {
      padding: 1rem 1.5rem;
      border-bottom: 1px solid var(--border);
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 1rem;
    }

    .db-panel-title { font-weight: 700; font-size: 0.88rem; letter-spacing: -0.01em; }
    .db-panel-body { padding: 1.5rem; }

    /* ── Table ────────────────────────────────── */
    .db-table-wrap { overflow-x: auto; }

    .db-table { width: 100%; border-collapse: collapse; font-size: 0.82rem; }

    .db-table th {
      background: var(--g50);
      padding: 0.65rem 1rem;
      text-align: left;
      font-size: 0.67rem;
      font-weight: 600;
      letter-spacing: 0.12em;
      text-transform: uppercase;
      color: var(--g400);
      border-bottom: 1px solid var(--border);
      white-space: nowrap;
    }

    .db-table td {
      padding: 0.85rem 1rem;
      border-bottom: 1px solid var(--border);
      color: var(--g600);
      vertical-align: middle;
    }

    .db-table tr:last-child td { border-bottom: none; }
    .db-table tr:hover td { background: var(--g50); }
    .db-table td.td-main { color: var(--black); font-weight: 500; }

    /* ── Badges ───────────────────────────────── */
    .badge {
      display: inline-block;
      padding: 0.2rem 0.55rem;
      border-radius: 100px;
      font-size: 0.62rem;
      font-weight: 700;
      letter-spacing: 0.08em;
      text-transform: uppercase;
    }

    .badge-pending   { background: #FEF3C7; color: var(--amber); }
    .badge-confirmed { background: #DCFCE7; color: var(--green); }
    .badge-shipped   { background: #DBEAFE; color: var(--blue); }
    .badge-cancelled { background: #FEE2E2; color: var(--red); }

    /* ── Action buttons ───────────────────────── */
    .btn-action {
      background: none;
      border: 1.5px solid var(--border);
      color: var(--g600);
      padding: 0.28rem 0.7rem;
      border-radius: 3px;
      font-family: 'Inter', sans-serif;
      font-size: 0.62rem;
      font-weight: 600;
      letter-spacing: 0.06em;
      text-transform: uppercase;
      cursor: pointer;
      transition: all 0.15s;
    }

    .btn-action:hover { background: var(--g100); }

    .btn-action.del { border-color: #FECACA; color: var(--red); }
    .btn-action.del:hover { background: #FEF2F2; }

    /* ── Forms ────────────────────────────────── */
    .db-form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; }

    .db-form-group { margin-bottom: 1rem; }

    .db-form-group label {
      display: block;
      font-size: 0.72rem;
      font-weight: 600;
      color: var(--g600);
      margin-bottom: 0.35rem;
      letter-spacing: 0.08em;
      text-transform: uppercase;
    }

    .db-form-group input,
    .db-form-group select,
    .db-form-group textarea {
      width: 100%;
      padding: 0.65rem 0.9rem;
      border: 1.5px solid var(--border);
      border-radius: 3px;
      font-family: 'Inter', sans-serif;
      font-size: 0.875rem;
      color: var(--black);
      background: var(--white);
      outline: none;
      transition: border-color 0.18s;
      appearance: none;
    }

    .db-form-group input:focus,
    .db-form-group select:focus,
    .db-form-group textarea:focus { border-color: var(--black); }

    .db-form-group textarea { resize: vertical; min-height: 80px; }

    .db-submit { margin-top: 0.5rem; }

    .db-btn {
      display: inline-block;
      background: var(--black);
      color: var(--white);
      padding: 0.65rem 1.75rem;
      border: none;
      border-radius: 3px;
      font-family: 'Inter', sans-serif;
      font-size: 0.82rem;
      font-weight: 600;
      cursor: pointer;
      transition: background 0.18s;
    }

    .db-btn:hover { background: #333; }

    /* ── Product thumb ────────────────────────── */
    .prod-thumb {
      width: 44px;
      height: 44px;
      border-radius: 3px;
      object-fit: cover;
      background: var(--g100);
      border: 1px solid var(--border);
    }

    /* ── Review card ──────────────────────────── */
    .db-review-grid { display: grid; grid-template-columns: repeat(auto-fill,minmax(280px,1fr)); gap: 1.25rem; }

    .db-review-card {
      background: var(--white);
      border: 1.5px solid var(--border);
      border-radius: 4px;
      padding: 1.25rem;
    }

    .db-review-top { display: flex; justify-content: space-between; align-items: flex-start; gap: 0.5rem; margin-bottom: 0.4rem; }
    .db-review-name { font-weight: 600; font-size: 0.88rem; }
    .db-review-date { font-size: 0.68rem; color: var(--g400); white-space: nowrap; }
    .db-review-stars { display: flex; gap: 1px; margin-bottom: 0.5rem; }
    .db-star-f { color: var(--black); font-size: 0.85rem; }
    .db-star-e { color: var(--g200); font-size: 0.85rem; }
    .db-review-comment { font-size: 0.82rem; color: var(--g600); font-weight: 300; line-height: 1.7; margin-bottom: 0.75rem; }

    /* ── Toast ────────────────────────────────── */
    .db-toast {
      position: fixed;
      bottom: 2rem;
      left: calc(240px + 50%);
      transform: translateX(-50%) translateY(12px);
      background: var(--black);
      color: var(--white);
      padding: 0.7rem 1.75rem;
      border-radius: 100px;
      font-size: 0.8rem;
      font-weight: 500;
      opacity: 0;
      transition: opacity 0.28s, transform 0.28s;
      pointer-events: none;
      z-index: 200;
      white-space: nowrap;
      box-shadow: 0 4px 20px rgba(0,0,0,0.2);
    }

    .db-toast.show { opacity: 1; transform: translateX(-50%) translateY(0); }

    /* ── Empty ────────────────────────────────── */
    .db-empty { text-align: center; padding: 3rem 2rem; color: var(--g400); font-size: 0.85rem; }
    .db-empty-icon { font-size: 2rem; margin-bottom: 0.6rem; opacity: 0.3; }

    /* ── Status select ────────────────────────── */
    .status-select {
      font-family: 'Inter', sans-serif;
      font-size: 0.72rem;
      font-weight: 600;
      padding: 0.25rem 0.5rem;
      border: 1.5px solid var(--border);
      border-radius: 3px;
      background: var(--white);
      cursor: pointer;
      outline: none;
    }

    /* ── Responsive ───────────────────────────── */
    @media (max-width: 1100px) { .stat-cards { grid-template-columns: repeat(2,1fr); } }
    @media (max-width: 820px) {
      .db-sidebar { display: none; }
      .db-main { margin-left: 0; }
      .db-content { padding: 1.25rem; }
      .stat-cards { grid-template-columns: 1fr 1fr; }
      .db-toast { left: 50%; }
    }
    @media (max-width: 480px) { .stat-cards { grid-template-columns: 1fr; } .db-form-grid { grid-template-columns: 1fr; } }
  </style>
</head>
<body>

  <!-- Sidebar -->
  <aside class="db-sidebar">
    <div class="db-logo">
      <div class="db-logo-name">Store<span>.</span></div>
      <div class="db-logo-sub">Admin Dashboard</div>
    </div>
    <nav class="db-nav">
      <button class="db-nav-btn active" data-section="overview">
        <svg class="db-nav-icon" viewBox="0 0 16 16" fill="currentColor"><rect x="1" y="1" width="6" height="6" rx="1"/><rect x="9" y="1" width="6" height="6" rx="1"/><rect x="1" y="9" width="6" height="6" rx="1"/><rect x="9" y="9" width="6" height="6" rx="1"/></svg>
        Overview
      </button>
      <button class="db-nav-btn" data-section="products">
        <svg class="db-nav-icon" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5"><rect x="2" y="2" width="5" height="5" rx="1"/><rect x="9" y="2" width="5" height="5" rx="1"/><rect x="2" y="9" width="5" height="5" rx="1"/><rect x="9" y="9" width="5" height="5" rx="1"/></svg>
        Products
      </button>
      <button class="db-nav-btn" data-section="orders">
        <svg class="db-nav-icon" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5"><rect x="1" y="3" width="14" height="10" rx="1"/><path d="M1 6h14"/><path d="M5 10h2M9 10h2"/></svg>
        Orders
      </button>
      <button class="db-nav-btn" data-section="reviews">
        <svg class="db-nav-icon" viewBox="0 0 16 16" fill="currentColor"><path d="M8 1.5l1.5 3.1 3.4.5-2.5 2.4.6 3.4L8 9.4l-3 1.5.6-3.4L3.1 5.1l3.4-.5z"/></svg>
        Reviews
      </button>
      <button class="db-nav-btn" data-section="pl">
        <svg class="db-nav-icon" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M2 13V5l6-3 6 3v8"/><path d="M8 13V8"/><path d="M5 10h6"/><rect x="2" y="10" width="12" height="3" rx="0.5"/></svg>
        P&amp;L
      </button>
    </nav>
    <div class="db-back"><a href="index.html">&#8592; Back to Store</a></div>
  </aside>

  <!-- Main -->
  <div class="db-main">
    <div class="db-topbar">
      <div class="db-topbar-title" id="topbarTitle">Overview</div>
      <div class="db-topbar-date" id="topbarDate"></div>
    </div>

    <div class="db-content">

      <!-- ── Overview ───────────────────────────── -->
      <div class="db-section active" id="sec-overview">
        <div class="db-page-title">Overview</div>
        <div class="db-page-sub">Your store at a glance</div>

        <div class="stat-cards">
          <div class="stat-card green">
            <div class="stat-label">Total Sales</div>
            <div class="stat-value" id="ov-sales">&pound;0</div>
            <div class="stat-note">From confirmed orders</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">Total Orders</div>
            <div class="stat-value" id="ov-orders">0</div>
            <div class="stat-note">All time</div>
          </div>
          <div class="stat-card amber">
            <div class="stat-label">Products</div>
            <div class="stat-value" id="ov-products">0</div>
            <div class="stat-note">In store</div>
          </div>
          <div class="stat-card blue">
            <div class="stat-label">Avg Rating</div>
            <div class="stat-value" id="ov-rating">&mdash;</div>
            <div class="stat-note">From reviews</div>
          </div>
        </div>

        <div class="db-panel">
          <div class="db-panel-head">
            <div class="db-panel-title">Recent Orders</div>
            <span style="font-size:0.72rem;color:var(--g400);">Last 5</span>
          </div>
          <div class="db-table-wrap">
            <table class="db-table">
              <thead><tr><th>Order ID</th><th>Customer</th><th>Items</th><th>Total</th><th>Date</th><th>Status</th></tr></thead>
              <tbody id="ov-orders-tbody"></tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- ── Products ────────────────────────────── -->
      <div class="db-section" id="sec-products">
        <div class="db-page-title">Products</div>
        <div class="db-page-sub">Add new products or remove existing ones</div>

        <div class="db-panel">
          <div class="db-panel-head"><div class="db-panel-title">Add New Product</div></div>
          <div class="db-panel-body">
            <form id="addProductForm" novalidate>
              <div class="db-form-grid">
                <div class="db-form-group">
                  <label for="pName">Product Name</label>
                  <input type="text" id="pName" placeholder="e.g. Black T-Shirt" required />
                </div>
                <div class="db-form-group">
                  <label for="pPrice">Price (&pound;)</label>
                  <input type="number" id="pPrice" placeholder="e.g. 29.99" min="0" step="0.01" required />
                </div>
                <div class="db-form-group">
                  <label for="pCategory">Category</label>
                  <select id="pCategory">
                    <option value="Clothing">Clothing</option>
                    <option value="Accessories">Accessories</option>
                    <option value="Home">Home</option>
                    <option value="Stationery">Stationery</option>
                    <option value="Other">Other</option>
                  </select>
                </div>
                <div class="db-form-group">
                  <label for="pImage">Image URL</label>
                  <input type="url" id="pImage" placeholder="https://example.com/image.jpg" />
                </div>
              </div>
              <div class="db-form-group">
                <label for="pDesc">Description</label>
                <textarea id="pDesc" placeholder="Short product description&hellip;"></textarea>
              </div>
              <div style="display:flex;align-items:center;gap:0.75rem;margin-bottom:1rem;">
                <input type="checkbox" id="pFeatured" style="width:16px;height:16px;cursor:pointer;" />
                <label for="pFeatured" style="font-size:0.82rem;font-weight:500;text-transform:none;letter-spacing:0;cursor:pointer;">Show on homepage as featured product</label>
              </div>
              <div class="db-submit">
                <button type="submit" class="db-btn">Add Product</button>
              </div>
            </form>
          </div>
        </div>

        <div class="db-panel">
          <div class="db-panel-head">
            <div class="db-panel-title">All Products</div>
            <span style="font-size:0.72rem;color:var(--g400);" id="products-count-label"></span>
          </div>
          <div class="db-table-wrap">
            <table class="db-table">
              <thead><tr><th>Image</th><th>Name</th><th>Price</th><th>Category</th><th>Featured</th><th>Action</th></tr></thead>
              <tbody id="products-tbody"></tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- ── Orders ──────────────────────────────── -->
      <div class="db-section" id="sec-orders">
        <div class="db-page-title">Orders</div>
        <div class="db-page-sub">View and manage all customer orders</div>

        <div class="db-panel">
          <div class="db-panel-head">
            <div class="db-panel-title">All Orders</div>
            <span style="font-size:0.72rem;color:var(--g400);" id="orders-count-label"></span>
          </div>
          <div class="db-table-wrap">
            <table class="db-table">
              <thead><tr><th>Order ID</th><th>Customer</th><th>Email</th><th>Items</th><th>Total</th><th>Date</th><th>Status</th></tr></thead>
              <tbody id="orders-tbody"></tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- ── Reviews ─────────────────────────────── -->
      <div class="db-section" id="sec-reviews">
        <div class="db-page-title">Reviews</div>
        <div class="db-page-sub">Manage customer reviews &mdash; delete any inappropriate ones</div>
        <div style="font-size:0.78rem;color:var(--g400);margin-bottom:1.25rem;text-transform:uppercase;letter-spacing:0.06em;" id="reviews-count-label"></div>
        <div class="db-review-grid" id="reviews-grid"></div>
      </div>

      <!-- ── P&L ──────────────────────────────────── -->
      <div class="db-section" id="sec-pl">
        <div class="db-page-title">Profit &amp; Loss</div>
        <div class="db-page-sub">Track revenue, expenses, and profitability</div>

        <div class="stat-cards" style="grid-template-columns:repeat(3,1fr);">
          <div class="stat-card green">
            <div class="stat-label">Total Revenue</div>
            <div class="stat-value" id="pl-revenue">&pound;0.00</div>
            <div class="stat-note">From all orders</div>
          </div>
          <div class="stat-card" style="border-top-color:var(--red);">
            <div class="stat-label">Total Expenses</div>
            <div class="stat-value" id="pl-expenses">&pound;0.00</div>
            <div class="stat-note">All recorded expenses</div>
          </div>
          <div class="stat-card">
            <div class="stat-label" id="pl-profit-label">Net Profit</div>
            <div class="stat-value" id="pl-profit">&pound;0.00</div>
            <div class="stat-note">Revenue minus expenses</div>
          </div>
        </div>

        <div class="db-panel">
          <div class="db-panel-head"><div class="db-panel-title">Add Expense</div></div>
          <div class="db-panel-body">
            <form id="addExpenseForm" novalidate>
              <div class="db-form-grid" style="grid-template-columns:1fr 1fr 1fr;">
                <div class="db-form-group">
                  <label for="expName">Expense Name</label>
                  <input type="text" id="expName" placeholder="e.g. Rent, Stock, Packaging" required />
                </div>
                <div class="db-form-group">
                  <label for="expAmount">Amount (&pound;)</label>
                  <input type="number" id="expAmount" placeholder="e.g. 150.00" min="0" step="0.01" required />
                </div>
                <div class="db-form-group">
                  <label for="expDate">Date</label>
                  <input type="date" id="expDate" required />
                </div>
              </div>
              <div class="db-submit">
                <button type="submit" class="db-btn">Add Expense</button>
              </div>
            </form>
          </div>
        </div>

        <div class="db-panel">
          <div class="db-panel-head">
            <div class="db-panel-title">All Expenses</div>
            <span style="font-size:0.72rem;color:var(--g400);" id="pl-expenses-count"></span>
          </div>
          <div class="db-table-wrap">
            <table class="db-table">
              <thead><tr><th>Name</th><th>Amount</th><th>Date</th><th>Action</th></tr></thead>
              <tbody id="pl-expenses-tbody"></tbody>
            </table>
          </div>
        </div>

        <div class="db-panel">
          <div class="db-panel-head"><div class="db-panel-title">Monthly Breakdown</div></div>
          <div class="db-table-wrap">
            <table class="db-table">
              <thead><tr><th>Month</th><th>Revenue</th><th>Expenses</th><th>Profit / Loss</th></tr></thead>
              <tbody id="pl-monthly-tbody"></tbody>
            </table>
          </div>
        </div>
      </div>

    </div>
  </div>

  <div class="db-toast" id="dbToast"></div>

  <script>
    /* ── Storage ──────────────────────────────────── */
    var SEED_PRODUCTS = [
      { id: 'p1', name: 'Classic White Tee', price: 29.99, description: 'A timeless crew-neck t-shirt in soft organic cotton. A wardrobe essential for any occasion.', image: 'https://picsum.photos/seed/whitete/600/600', category: 'Clothing', featured: true },
      { id: 'p2', name: 'Black Hoodie', price: 54.99, description: 'A heavyweight pullover hoodie with a relaxed fit. Warm, durable, and endlessly versatile.', image: 'https://picsum.photos/seed/hoodie1/600/600', category: 'Clothing', featured: true },
      { id: 'p3', name: 'Canvas Tote Bag', price: 19.99, description: 'A sturdy natural canvas tote with reinforced handles. Perfect for shopping, travel, or everyday use.', image: 'https://picsum.photos/seed/totebag/600/600', category: 'Accessories', featured: true },
      { id: 'p4', name: 'Slim Leather Wallet', price: 39.99, description: 'A slim bi-fold wallet in full-grain leather. Cards, notes, and essentials without the bulk.', image: 'https://picsum.photos/seed/wallet1/600/600', category: 'Accessories', featured: true },
      { id: 'p5', name: 'Minimal Watch', price: 89.99, description: 'A clean dial watch with a genuine leather strap. Japanese quartz movement, water resistant to 30m.', image: 'https://picsum.photos/seed/watch1/600/600', category: 'Accessories', featured: false },
      { id: 'p6', name: 'Ceramic Mug', price: 14.99, description: 'A minimalist 350ml ceramic mug. Dishwasher and microwave safe with a comfortable handle.', image: 'https://picsum.photos/seed/mug1/600/600', category: 'Home', featured: false },
      { id: 'p7', name: 'Hardback Notebook', price: 16.99, description: 'An A5 dot-grid notebook with a matte hardback cover. 192 pages of premium off-white paper.', image: 'https://picsum.photos/seed/notebook1/600/600', category: 'Stationery', featured: false },
      { id: 'p8', name: 'Slim Chinos', price: 44.99, description: 'Tailored slim-fit chinos in a neutral tone. Smart enough for the office, casual for weekends.', image: 'https://picsum.photos/seed/chinos1/600/600', category: 'Clothing', featured: false }
    ];

    function loadProducts() {
      try { var s = localStorage.getItem('ec_products'); if (s) return JSON.parse(s); } catch(e) {}
      localStorage.setItem('ec_products', JSON.stringify(SEED_PRODUCTS));
      return SEED_PRODUCTS;
    }

    function saveProducts(arr) { localStorage.setItem('ec_products', JSON.stringify(arr)); }
    function loadOrders()  { try { return JSON.parse(localStorage.getItem('ec_orders')  || '[]'); } catch(e) { return []; } }
    function saveOrders(a) { localStorage.setItem('ec_orders', JSON.stringify(a)); }
    function loadReviews() { try { return JSON.parse(localStorage.getItem('ec_reviews') || '[]'); } catch(e) { return []; } }
    function saveReviews(a){ localStorage.setItem('ec_reviews', JSON.stringify(a)); }

    function esc(s) {
      return String(s||'').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;');
    }

    function starsHTML(n) {
      var h = '';
      for (var i = 1; i <= 5; i++) h += '<span class="' + (i<=n?'db-star-f':'db-star-e') + '">&#9733;</span>';
      return h;
    }

    function showToast(msg) {
      var t = document.getElementById('dbToast');
      t.textContent = msg; t.classList.add('show');
      setTimeout(function() { t.classList.remove('show'); }, 2600);
    }

    /* ── Topbar date ──────────────────────────────── */
    (function() {
      var d = new Date();
      var days = ['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'];
      var months = ['January','February','March','April','May','June','July','August','September','October','November','December'];
      document.getElementById('topbarDate').textContent = days[d.getDay()] + ', ' + d.getDate() + ' ' + months[d.getMonth()] + ' ' + d.getFullYear();
    })();

    /* ── Section nav ──────────────────────────────── */
    var titles = { overview:'Overview', products:'Products', orders:'Orders', reviews:'Reviews', pl:'P&L' };

    document.querySelectorAll('.db-nav-btn').forEach(function(btn) {
      btn.addEventListener('click', function() {
        var t = btn.getAttribute('data-section');
        document.querySelectorAll('.db-nav-btn').forEach(function(b) { b.classList.remove('active'); });
        btn.classList.add('active');
        document.querySelectorAll('.db-section').forEach(function(s) { s.classList.remove('active'); });
        document.getElementById('sec-' + t).classList.add('active');
        document.getElementById('topbarTitle').textContent = titles[t];
        if (t === 'overview') renderOverview();
        if (t === 'products') renderProducts();
        if (t === 'orders')   renderOrders();
        if (t === 'reviews')  renderReviews();
        if (t === 'pl')       renderPL();
      });
    });

    /* ── Overview ─────────────────────────────────── */
    function renderOverview() {
      var orders   = loadOrders();
      var products = loadProducts();
      var reviews  = loadReviews();

      var totalSales = orders.reduce(function(s, o) { return s + (o.total || 0); }, 0);
      var avgRating  = reviews.length
        ? (reviews.reduce(function(s,r){return s+r.rating;},0)/reviews.length).toFixed(1)
        : null;

      document.getElementById('ov-sales').textContent    = '\u00a3' + totalSales.toFixed(2);
      document.getElementById('ov-orders').textContent   = orders.length;
      document.getElementById('ov-products').textContent = products.length;
      document.getElementById('ov-rating').textContent   = avgRating ? avgRating + '\u2605' : '\u2014';

      var recent = orders.slice().reverse().slice(0, 5);
      var tbody  = document.getElementById('ov-orders-tbody');

      if (recent.length === 0) {
        tbody.innerHTML = '<tr><td colspan="6" style="text-align:center;color:var(--g400);padding:2.5rem;">No orders yet</td></tr>';
        return;
      }

      tbody.innerHTML = recent.map(function(o) {
        return '<tr>' +
          '<td class="td-main">#' + esc(o.id.slice(-6)) + '</td>' +
          '<td>' + esc(o.name) + '</td>' +
          '<td>' + (o.items ? o.items.length : 0) + ' item' + (o.items && o.items.length !== 1 ? 's' : '') + '</td>' +
          '<td class="td-main">\u00a3' + (o.total || 0).toFixed(2) + '</td>' +
          '<td>' + esc(o.date) + '</td>' +
          '<td><span class="badge badge-' + esc(o.status) + '">' + esc(o.status) + '</span></td>' +
          '</tr>';
      }).join('');
    }

    /* ── Products ─────────────────────────────────── */
    document.getElementById('addProductForm').addEventListener('submit', function(e) {
      e.preventDefault();
      var name  = document.getElementById('pName').value.trim();
      var price = parseFloat(document.getElementById('pPrice').value);
      if (!name || isNaN(price) || price < 0) { showToast('Please fill in name and price.'); return; }

      var product = {
        id:          'p' + Date.now(),
        name:        name,
        price:       price,
        description: document.getElementById('pDesc').value.trim(),
        image:       document.getElementById('pImage').value.trim() || 'https://picsum.photos/seed/' + Date.now() + '/600/600',
        category:    document.getElementById('pCategory').value,
        featured:    document.getElementById('pFeatured').checked
      };

      var products = loadProducts();
      products.push(product);
      saveProducts(products);
      this.reset();
      renderProducts();
      showToast('Product added');
    });

    function deleteProduct(id) {
      if (!confirm('Delete this product?')) return;
      var products = loadProducts().filter(function(p) { return p.id !== id; });
      saveProducts(products);
      renderProducts();
      showToast('Product deleted');
    }

    function toggleFeatured(id) {
      var products = loadProducts().map(function(p) {
        if (p.id === id) p.featured = !p.featured;
        return p;
      });
      saveProducts(products);
      renderProducts();
      showToast('Updated');
    }

    function renderProducts() {
      var products = loadProducts();
      document.getElementById('products-count-label').textContent = products.length + ' product' + (products.length !== 1 ? 's' : '');
      var tbody = document.getElementById('products-tbody');

      if (products.length === 0) {
        tbody.innerHTML = '<tr><td colspan="6" style="text-align:center;color:var(--g400);padding:2.5rem;">No products yet. Add one above.</td></tr>';
        return;
      }

      tbody.innerHTML = products.map(function(p) {
        return '<tr>' +
          '<td><img class="prod-thumb" src="' + esc(p.image) + '" alt="" /></td>' +
          '<td class="td-main">' + esc(p.name) + '</td>' +
          '<td>\u00a3' + p.price.toFixed(2) + '</td>' +
          '<td>' + esc(p.category) + '</td>' +
          '<td>' +
            '<button class="btn-action" onclick="toggleFeatured(\'' + p.id + '\')" style="' + (p.featured ? 'background:#F0FDF4;color:var(--green);border-color:#BBF7D0;' : '') + '">' +
              (p.featured ? 'Yes' : 'No') +
            '</button>' +
          '</td>' +
          '<td><button class="btn-action del" onclick="deleteProduct(\'' + p.id + '\')">Delete</button></td>' +
          '</tr>';
      }).join('');
    }

    /* ── Orders ───────────────────────────────────── */
    function updateOrderStatus(id, status) {
      var orders = loadOrders().map(function(o) { if (o.id === id) o.status = status; return o; });
      saveOrders(orders);
      renderOrders();
      if (document.getElementById('sec-overview').classList.contains('active')) renderOverview();
      showToast('Order updated');
    }

    function renderOrders() {
      var orders = loadOrders().slice().reverse();
      document.getElementById('orders-count-label').textContent = orders.length + ' order' + (orders.length !== 1 ? 's' : '');
      var tbody = document.getElementById('orders-tbody');

      if (orders.length === 0) {
        tbody.innerHTML = '<tr><td colspan="7" style="text-align:center;color:var(--g400);padding:2.5rem;">No orders yet</td></tr>';
        return;
      }

      tbody.innerHTML = orders.map(function(o) {
        var statusOpts = ['pending','confirmed','shipped','cancelled'].map(function(s) {
          return '<option value="' + s + '"' + (o.status === s ? ' selected' : '') + '>' + s.charAt(0).toUpperCase() + s.slice(1) + '</option>';
        }).join('');

        return '<tr>' +
          '<td class="td-main">#' + esc(o.id.slice(-6)) + '</td>' +
          '<td>' + esc(o.name) + '</td>' +
          '<td>' + esc(o.email) + '</td>' +
          '<td>' + (o.items ? o.items.map(function(i){return i.name+' \u00d7'+i.quantity;}).join(', ') : '') + '</td>' +
          '<td class="td-main">\u00a3' + (o.total || 0).toFixed(2) + '</td>' +
          '<td>' + esc(o.date) + '</td>' +
          '<td>' +
            '<select class="status-select" onchange="updateOrderStatus(\'' + o.id + '\', this.value)">' + statusOpts + '</select>' +
          '</td>' +
          '</tr>';
      }).join('');
    }

    /* ── Reviews ──────────────────────────────────── */
    function deleteReview(idx) {
      if (!confirm('Delete this review?')) return;
      var reviews = loadReviews();
      reviews.splice(idx, 1);
      saveReviews(reviews);
      renderReviews();
      showToast('Review deleted');
    }

    function renderReviews() {
      var reviews = loadReviews();
      document.getElementById('reviews-count-label').textContent = reviews.length + ' review' + (reviews.length !== 1 ? 's' : '');
      var grid = document.getElementById('reviews-grid');

      if (reviews.length === 0) {
        grid.innerHTML = '<div class="db-empty" style="grid-column:1/-1"><div class="db-empty-icon">&#11088;</div>No reviews yet</div>';
        return;
      }

      grid.innerHTML = reviews.slice().reverse().map(function(r, i) {
        var realIdx = reviews.length - 1 - i;
        return '<div class="db-review-card">' +
          '<div class="db-review-top">' +
            '<div><div class="db-review-name">' + esc(r.name) + '</div><div class="db-review-date">' + esc(r.date) + '</div></div>' +
            '<button class="btn-action del" onclick="deleteReview(' + realIdx + ')">Delete</button>' +
          '</div>' +
          '<div class="db-review-stars">' + starsHTML(r.rating) + '</div>' +
          '<p class="db-review-comment">' + esc(r.comment) + '</p>' +
        '</div>';
      }).join('');
    }

    /* ── P&L ──────────────────────────────────────── */
    function loadExpenses()  { try { return JSON.parse(localStorage.getItem('ec_expenses') || '[]'); } catch(e) { return []; } }
    function saveExpenses(a) { localStorage.setItem('ec_expenses', JSON.stringify(a)); }

    function deleteExpense(id) {
      if (!confirm('Delete this expense?')) return;
      saveExpenses(loadExpenses().filter(function(e) { return e.id !== id; }));
      renderPL();
      showToast('Expense deleted');
    }

    document.getElementById('addExpenseForm').addEventListener('submit', function(e) {
      e.preventDefault();
      var name   = document.getElementById('expName').value.trim();
      var amount = parseFloat(document.getElementById('expAmount').value);
      var date   = document.getElementById('expDate').value;
      if (!name || isNaN(amount) || amount < 0 || !date) { showToast('Please fill in all expense fields.'); return; }
      var expenses = loadExpenses();
      expenses.push({ id: Date.now().toString(), name: name, amount: amount, date: date });
      saveExpenses(expenses);
      this.reset();
      renderPL();
      showToast('Expense added');
    });

    function renderPL() {
      var orders   = loadOrders();
      var expenses = loadExpenses();

      var totalRevenue  = orders.reduce(function(s, o) { return s + (o.total || 0); }, 0);
      var totalExpenses = expenses.reduce(function(s, e) { return s + (e.amount || 0); }, 0);
      var netProfit     = totalRevenue - totalExpenses;

      document.getElementById('pl-revenue').textContent  = '\u00a3' + totalRevenue.toFixed(2);
      document.getElementById('pl-expenses').textContent = '\u00a3' + totalExpenses.toFixed(2);

      var profitEl = document.getElementById('pl-profit');
      profitEl.textContent = (netProfit < 0 ? '-' : '') + '\u00a3' + Math.abs(netProfit).toFixed(2);
      profitEl.style.color = netProfit >= 0 ? 'var(--green)' : 'var(--red)';
      document.getElementById('pl-profit-label').textContent = netProfit >= 0 ? 'Net Profit' : 'Net Loss';
      document.getElementById('pl-profit').closest('.stat-card').style.borderTopColor = netProfit >= 0 ? 'var(--green)' : 'var(--red)';

      /* Expenses table */
      var ecountLabel = document.getElementById('pl-expenses-count');
      ecountLabel.textContent = expenses.length + ' expense' + (expenses.length !== 1 ? 's' : '');
      var etbody = document.getElementById('pl-expenses-tbody');

      var monthNames = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
      function fmtDate(ym) {
        var parts = ym.split('-');
        return monthNames[parseInt(parts[1],10)-1] + ' ' + parts[0];
      }

      if (expenses.length === 0) {
        etbody.innerHTML = '<tr><td colspan="4" style="text-align:center;color:var(--g400);padding:2.5rem;">No expenses added yet</td></tr>';
      } else {
        etbody.innerHTML = expenses.slice().reverse().map(function(e) {
          var parts = e.date ? e.date.split('-') : null;
          var dateLabel = parts ? fmtDate(e.date.slice(0,7)) + ' ' + parseInt(parts[2],10) : esc(e.date);
          return '<tr>' +
            '<td class="td-main">' + esc(e.name) + '</td>' +
            '<td>\u00a3' + (e.amount || 0).toFixed(2) + '</td>' +
            '<td>' + esc(e.date) + '</td>' +
            '<td><button class="btn-action del" onclick="deleteExpense(\'' + e.id + '\')">Delete</button></td>' +
            '</tr>';
        }).join('');
      }

      /* Monthly breakdown */
      var monthly = {};
      orders.forEach(function(o) {
        var ym = o.rawDate ? o.rawDate.slice(0,7) : null;
        if (!ym) return;
        if (!monthly[ym]) monthly[ym] = { revenue: 0, expenses: 0 };
        monthly[ym].revenue += (o.total || 0);
      });
      expenses.forEach(function(e) {
        var ym = e.date ? e.date.slice(0,7) : null;
        if (!ym) return;
        if (!monthly[ym]) monthly[ym] = { revenue: 0, expenses: 0 };
        monthly[ym].expenses += (e.amount || 0);
      });

      var keys   = Object.keys(monthly).sort().reverse();
      var mtbody = document.getElementById('pl-monthly-tbody');

      if (keys.length === 0) {
        mtbody.innerHTML = '<tr><td colspan="4" style="text-align:center;color:var(--g400);padding:2.5rem;">No data yet</td></tr>';
      } else {
        mtbody.innerHTML = keys.map(function(ym) {
          var rev    = monthly[ym].revenue;
          var exp    = monthly[ym].expenses;
          var profit = rev - exp;
          var pStyle = profit >= 0 ? 'color:var(--green);font-weight:600;' : 'color:var(--red);font-weight:600;';
          return '<tr>' +
            '<td class="td-main">' + fmtDate(ym) + '</td>' +
            '<td>\u00a3' + rev.toFixed(2) + '</td>' +
            '<td>\u00a3' + exp.toFixed(2) + '</td>' +
            '<td style="' + pStyle + '">' + (profit < 0 ? '-' : '') + '\u00a3' + Math.abs(profit).toFixed(2) + '</td>' +
            '</tr>';
        }).join('');
      }
    }

    /* ── Init ─────────────────────────────────────── */
    loadProducts(); // seed if empty
    renderOverview();
  </script>

</body>
</html>
